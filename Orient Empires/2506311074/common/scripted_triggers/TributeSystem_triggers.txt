############# TributeSystem_triggers
# by 往来天地间 WangLaiTianDiJian
# TributeSystem

#WLTDJ20220123

is_tributary = {
	exists = var:my_suzerain
	any_relation = {
		type = suzerain
		exists = this
		is_alive = yes
	}
#	var:my_suzerain = {
#		OR = {
#			is_target_in_variable_list = { name = non_permanent_tributaries target = prev }
#			is_target_in_variable_list = { name = permanent_tributaries target = prev }
#		}
#	}
}

is_permanent_tributary = {
	$SUZERAIN$ = {
		is_target_in_variable_list = { name = permanent_tributaries target =  $TRIBUTARY$ }
	}
}

is_non_permanent_tributary = {
	$SUZERAIN$ = {
		is_target_in_variable_list = { name = non_permanent_tributaries target =  $TRIBUTARY$ }
	}
}

is_suzerain = {
	any_relation = {
		type = tributary
		exists = this
		is_alive = yes
	}
}

TributeSystem_can_be_tributary_of_trigger = {#可以成为其朝贡国
	is_landed = yes
	is_independent_ruler = yes
	#tier_difference = {
		#target = $SUZERAIN$
		#value < 0
	#}
	NOR = {
		is_tributary = yes
		is_suzerain = yes
	}
	NOR = {
		any_liege_or_above = {
			this = $SUZERAIN$
		}	
		any_vassal_or_below = {
			this = $SUZERAIN$
		}
		has_relation_suzerain = $SUZERAIN$	
	}
	NOT = { this = $SUZERAIN$ }
	NOT = { is_at_war_with = $SUZERAIN$ }
	NOT = { is_causing_raid_hostility_towards = $SUZERAIN$ }
}

can_be_suzerain_trigger = {
	NOT = {
		is_tributary = yes
	}
	is_at_war = no				
	highest_held_title_tier >= tier_kingdom
	is_independent_ruler = yes
}

TributeSystem_can_be_suzerain_of_trigger = {#可以成为其宗主国
	has_royal_court = yes
	is_independent_ruler = yes
	NOT = { is_vassal_or_below_of = $TRIBUTARY$ } 
	NOT = { is_liege_or_above_of = $TRIBUTARY$ }
	NOT = { this = $TRIBUTARY$ }
	NOT = { is_at_war_with = $TRIBUTARY$ }
	NOT = { is_causing_raid_hostility_towards = $TRIBUTARY$ }
	NOT = { has_relation_tributary = $TRIBUTARY$ }
}


TributeSystem_can_attack_to_force_to_be_suzerain_of_trigger = {
	#	has_perk = forced_vassalage_perk
		is_ai = no
		TributeSystem_can_demand_tribute_of_trigger_trigger = { TRIBUTARY = $TRIBUTARY$ }
		NOT = { is_at_war_with = $TRIBUTARY$ }
		NOT = { is_allied_in_war = $TRIBUTARY$ }
		NOT = { is_allied_to = $TRIBUTARY$ }
}


#同宗朝贡国
TributeSystem_is_same_heritage_tributary_of_trigger = {
	has_relation_suzerain = $SUZERAIN$
	OR = {
		#culture = { has_same_culture_heritage = $SUZERAIN$.culture }
		has_faith = $SUZERAIN$.faith
		dynasty = $SUZERAIN$.dynasty
		is_allied_to = $SUZERAIN$
	}

}
#部落朝贡国
TributeSystem_is_tribal_tributary_of_trigger = {
	has_relation_suzerain = $SUZERAIN$
	OR = {
		has_government = tribal_government
		has_government = ulus_government
	}
}
#封建朝贡国
TributeSystem_is_feudal_tributary_of_trigger = {
	has_relation_suzerain = $SUZERAIN$
	OR = {
		has_government = feudal_government
		has_government = clan_government
		has_government = republic_government
		has_government = legion_government
	}
}
#律令朝贡国
TributeSystem_is_celestial_tributary_of_trigger = {
	has_relation_suzerain = $SUZERAIN$
	OR = {
		has_government = celestial_government
		has_government = bureau_government
	}
}
