############# TributeSystem_triggers
# by 往来天地间 WangLaiTianDiJian
# TributeSystem

#WLTDJ20220123

is_suzerain = {
	#has_trait = suzerain
	any_relation = {
		type = tributary
		exists = this
		is_alive = yes
	}
}

is_tributary = {
	exists = var:my_suzerain
	any_relation = {
		type = suzerain
		exists = this
		is_alive = yes
	}
}

has_tributaries = {
	OR = {
		any_relation = {
			type = tributary
			is_alive = yes
			count > 0
		}
		variable_list_size = { name = all_tributaries value > 0 }
	}
}

is_permanent_tributary = {
	has_variable = tributary_type
	var:tributary_type = flag:permanent
	#$SUZERAIN$ = {
		#is_target_in_variable_list = { name = permanent_tributaries target =  $TRIBUTARY$ }
	#}
}

is_non_permanent_tributary = {
	has_variable = tributary_type
	var:tributary_type = flag:non_permanent
	#$SUZERAIN$ = {
		#is_target_in_variable_list = { name = non_permanent_tributaries target =  $TRIBUTARY$ }
	#}
}

has_permanent_tributaries = {
	any_in_list = { list = permanent_tributaries count > 0 }
}

has_non_permanent_tributaries = {
	any_in_list = { list = non_permanent_tributaries count > 0 } #target
}

can_be_tributary_trigger = {
	NOT = { is_suzerain = yes }
	is_alive = yes		
	primary_title.tier > tier_barony
	is_independent_ruler = yes
}

TributeSystem_can_be_tributary_of_trigger = {#可以成为其朝贡国
	is_independent_ruler = yes
	primary_title.tier > tier_barony
	NOT = { is_vassal_or_below_of = $SUZERAIN$ } 
	NOT = { is_liege_or_above_of = $SUZERAIN$ }
	NOT = { this = $SUZERAIN$ }

	tier_difference = {
		target = $SUZERAIN$
		value < 0
	}
	NOT = { is_at_war_with = $SUZERAIN$ }
	NOT = { is_causing_raid_hostility_towards = $SUZERAIN$ }
	$SUZERAIN$ = {
		is_independent_ruler = yes
		primary_title.tier > tier_barony
	}
}

can_be_suzerain_trigger = {
	NOT = { is_tributary = yes }
	is_alive = yes		
	highest_held_title_tier >= tier_kingdom
	is_independent_ruler = yes
}

TributeSystem_can_be_suzerain_of_trigger = {#可以成为其宗主国
	is_independent_ruler = yes
	primary_title.tier > tier_barony
	NOT = { is_vassal_or_below_of = $TRIBUTARY$ } 
	NOT = { is_liege_or_above_of = $TRIBUTARY$ }
	NOT = { this = $TRIBUTARY$ }
	tier_difference = {
		target = $TRIBUTARY$
		value > 0
	}

	NOT = { is_at_war_with = $TRIBUTARY$ }
	NOT = { is_causing_raid_hostility_towards = $TRIBUTARY$ }
	$TRIBUTARY$ = {
		is_independent_ruler = yes
		primary_title.tier > tier_barony
	}
}


TributeSystem_can_attack_to_force_to_be_suzerain_of_trigger = {
	#	has_perk = forced_vassalage_perk
		is_ai = no
		TributeSystem_can_be_suzerain_of_trigger = { TRIBUTARY = $TRIBUTARY$ }
		NOT = { is_at_war_with = $TRIBUTARY$ }
		NOT = { is_allied_in_war = $TRIBUTARY$ }
		NOT = { is_allied_to = $TRIBUTARY$ }
}


#同宗朝贡国
TributeSystem_is_same_heritage_tributary_of_trigger = {
	has_relation_suzerain = $SUZERAIN$
	OR = {
		#culture = { has_same_culture_heritage = $SUZERAIN$.culture }
		has_faith = $SUZERAIN$.faith
		dynasty = $SUZERAIN$.dynasty
		is_allied_to = $SUZERAIN$
	}

}
#王化朝贡国
TributeSystem_is_civilized_tributary_of_trigger = {
	has_relation_suzerain = $SUZERAIN$
	$SUZERAIN$ = {
		has_royal_court = yes
		OR = {
			has_court_type = court_scholarly
			has_court_type = court_diplomatic
		}
	}
}
#互市朝贡国
TributeSystem_is_league_tributary_of_trigger = {
	has_relation_suzerain = $SUZERAIN$
	$SUZERAIN$ = {
		has_royal_court = yes
		OR = {
			has_court_type = court_administrative
		}
	}
}
#臣服朝贡国
TributeSystem_is_hegemony_tributary_of_trigger = {
	has_relation_suzerain = $SUZERAIN$
	$SUZERAIN$ = {
		has_royal_court = yes
		OR = {
			has_court_type = court_intrigue
			has_court_type = court_tribal
			has_court_type = court_warlike
		}
	}
}

