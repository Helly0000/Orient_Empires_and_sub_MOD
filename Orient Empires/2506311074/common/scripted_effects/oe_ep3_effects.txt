# Picks a random valid maa type for OWNER to create
ep3_pick_random_maa_regiment_effect = {
	save_temporary_scope_value_as = {
		name = include_basic_maa
		value = $INCLUDE_BASIC_MAA$
	}
	save_temporary_scope_value_as = {
		name = include_siege_maa
		value = $INCLUDE_SIEGE_MAA$
	}
	$OWNER$ = {
		random_list = {
			1 = {
				trigger = {
					scope:include_basic_maa = yes
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:light_footmen
				}
			}
			1 = {
				trigger = {
					scope:include_basic_maa = yes
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:bowmen
				}
			}
			1 = {
				trigger = {
					scope:include_basic_maa = yes
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:light_horsemen
				}
			}
			1 = {
				trigger = {
					scope:include_basic_maa = yes
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:pikemen_unit
				}
			}
			# TRIBAL
			1 = {
				trigger = {
					culture = { has_innovation = innovation_elephantry }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:war_elephant
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_war_camels }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:camel_rider
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_arched_saddle }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:armored_horsemen
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_catapult }
					scope:include_siege_maa = yes
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:onager
				}
			}
			# EARLY
			1 = {
				trigger = {
					culture = { has_innovation = innovation_quilted_armor }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:armored_footmen
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_mangonel }
					scope:include_siege_maa = yes
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:mangonel
				}
			}
			# HIGH
			1 = {
				trigger = {
					culture = { has_innovation = innovation_trebuchet }
					scope:include_siege_maa = yes
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:trebuchet
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_advanced_bowmaking }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:crossbowmen
				}
			}
			# LATE
			1 = {
				trigger = {
					culture = { has_innovation = innovation_bombard }
					scope:include_siege_maa = yes
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:bombard
				}
			}
			# CULTURAL INNOVATIONS
			1 = {
				trigger = {
					culture = { has_innovation = innovation_bamboo_bows }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:paiks
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_zweihanders }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:landsknecht
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_adaptive_militia }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:goedendag
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_valets }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:gendarme
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_pike_columns }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:picchieri
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_legionnaires }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:praetorian
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_desert_tactics }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:chasseur
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_caballeros }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:caballero
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_hobbies }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:hobelar
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_rectilinear_schiltron }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:schiltron
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_sahel_horsemen }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:sahel_horsemen
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_sarawit }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:sarawit
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_repeating_crossbow }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:chu_ko_nu
				}
			}
			#OE
			1 = {
				trigger = {
					culture = { has_innovation = innovation_centralization_of_authority }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:china_west_modao
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_centralization_of_authority }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:thunder
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_world_cathay }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:cathay_ps
				}
			}
			1 = {
				trigger = {
					culture = { has_innovation = innovation_target_region_liangjing }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:china_centre_jj
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_mangudai }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:mangudai
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_samurai }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:samurai
				}
			}

			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_china_east_ms }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:china_east_ms
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_china_south_wd }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:china_south_wd
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_asia_tunguse_ss }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:asia_tunguse_ss
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_java_warrior }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:java_warrior
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:saber_attribute
						}
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:tiancejun
				}
			}			
			#
			1 = {
				trigger = {
					culture = { has_innovation = innovation_pole_vault }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:guanch_vaulter
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_huscarls }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:huscarl
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_longbowmen }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:longbowmen
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_monaspa }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:monaspa
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_cataphract }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:cataphract
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_metsanvartija }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:metsanvartija
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_horse_archers }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:horse_archers
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_ayyar }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:ayyar
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_mubarizun }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:mubarizun
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_mulaththamun }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:mulaththamun
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_archers_of_the_nile }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:archers_of_the_nile
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_druzhina }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:druzhina
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_hussar }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:hussar
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_horn_warrior }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:horn_warrior
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_bush_hunter }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:bush_hunter
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_shomer }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:shomer
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_garudas }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:garudas
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_khandayat }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:khandayat
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_mountaineer }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:mountaineer
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_guinea_warrior }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:guinea_warrior
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_abudrar }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:abudrar
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_zbrojnosh }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:zbrojnosh
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_palace_guards }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:palace_guards
				}
			}
			1 = {
				trigger = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = fp3_khvarenah_legacy_4
					}	
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:asawira
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_tarkhan }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:tarkhan
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_zupin_warrior }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:zupin_warrior
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_tawashi }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:tawashi
				}
			}
			1 = {
				trigger = {
					exists = dynasty
					dynasty = {
						has_dynasty_perk = warfare_legacy_5
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:house_guard
				}
			}
			1 = {
				trigger = {
					any_active_accolade = { 
						primary_type = {
							this = accolade_type:archer_attribute
						}
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_archers
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:skirmisher_attribute
						} 
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_skirmishers
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:pike_attribute
						} 
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_pikes
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:outrider_attribute
						}  
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_outriders
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:vanguard_attribute
						}
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_vanguards
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:lancer_attribute
						}
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_lancers
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:crossbowmen_attribute
						}
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_crossbowers
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:camelry_attribute
						} 
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_cameliers
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:elephantry_attribute
						} 
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_elephantiers
				}
			}
			1 = {
				trigger = {
					any_active_accolade = {
						primary_type = {
							this = accolade_type:horse_archer_attribute
						}
						accolade_rank >= 3
					}
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:accolade_maa_horse_archers
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_vigmen }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:vigmen
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_bondi }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:bondi
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_varangian_veterans }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:varangian_veterans
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_ayrudzi }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:ayrudzi
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_conrois }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:conrois
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_akritai }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:akritai
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_ballistrai }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:ballistrai
				}
			}
			1 = {
				trigger = {
					culture = { has_cultural_parameter = unlock_maa_skoutatoi }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:skoutatoi
				}
			}
			1 = {
				trigger = {
					exists = scope:title
					scope:title = title:e_byzantium
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:varangian_guards
				}
			} 
			1 = {
				trigger = {
			   		domicile ?= { has_domicile_parameter = camp_unlocks_handpicked_faithful_maa_type }
				}
				save_scope_value_as = {
					name = maa_to_create
					value = flag:handpicked_faithful
				}
			}
		}
	}
	#in case you don't fullfil any criteria just pick a random default maa
	if = {
		limit = {
			NOT = { exists = scope:maa_to_create }
		}
		random_list = {
			1 = {
				save_scope_value_as = {
					name = maa_to_create
					value = flag:light_footmen
				}
			}
			1 = {
				save_scope_value_as = {
					name = maa_to_create
					value = flag:bowmen
				}
			}
			1 = {
				save_scope_value_as = {
					name = maa_to_create
					value = flag:light_horsemen
				}
			}
			1 = {
				save_scope_value_as = {
					name = maa_to_create
					value = flag:pikemen_unit
				}
			}
		}
	}
}

# creates the maa type for OWNER of SIZE set by the above
ep3_create_random_maa_regiment_effect = {
	$OWNER$ = {
		switch = {
			trigger = scope:maa_to_create
			flag:light_footmen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = light_footmen
					SIZE = $SIZE$
				}
			}
			flag:bowmen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = bowmen
					SIZE = $SIZE$
				}
			}
			flag:light_horsemen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = light_horsemen
					SIZE = $SIZE$
				}
			}
			flag:pikemen_unit = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = pikemen_unit
					SIZE = $SIZE$
				}
			}
			flag:war_elephant = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = war_elephant
					SIZE = $SIZE$
				}
			}
			flag:camel_rider = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = camel_rider
					SIZE = $SIZE$
				}
			}
			flag:armored_horsemen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = armored_horsemen
					SIZE = $SIZE$
				}
			}
			flag:onager = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = onager
					SIZE = $SIZE$
				}
			}
			flag:armored_footmen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = armored_footmen
					SIZE = $SIZE$
				}
			}
			flag:mangonel = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = mangonel
					SIZE = $SIZE$
				}
			}
			flag:trebuchet = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = trebuchet
					SIZE = $SIZE$
				}
			}
			flag:crossbowmen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = crossbowmen
					SIZE = $SIZE$
				}
			}
			flag:bombard = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = bombard
					SIZE = $SIZE$
				}
			}
			flag:paiks = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = paiks
					SIZE = $SIZE$
				}
			}
			flag:landsknecht = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = landsknecht
					SIZE = $SIZE$
				}
			}
			flag:goedendag = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = goedendag
					SIZE = $SIZE$
				}
			}
			flag:gendarme = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = gendarme
					SIZE = $SIZE$
				}
			}
			flag:picchieri = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = picchieri
					SIZE = $SIZE$
				}
			}
			flag:praetorian = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = praetorian
					SIZE = $SIZE$
				}
			}
			flag:chasseur = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = chasseur
					SIZE = $SIZE$
				}
			}
			flag:caballero = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = caballero
					SIZE = $SIZE$
				}
			}
			flag:hobelar = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = hobelar
					SIZE = $SIZE$
				}
			}
			flag:schiltron = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = schiltron
					SIZE = $SIZE$
				}
			}
			flag:sahel_horsemen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = sahel_horsemen
					SIZE = $SIZE$
				}
			}
			flag:sarawit = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = sarawit
					SIZE = $SIZE$
				}
			}
			flag:chu_ko_nu = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = chu_ko_nu
					SIZE = $SIZE$
				}
			}
			flag:guanch_vaulter = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = guanch_vaulter
					SIZE = $SIZE$
				}
			}
			flag:huscarl = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = huscarl
					SIZE = $SIZE$
				}
			}
			flag:longbowmen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = longbowmen
					SIZE = $SIZE$
				}
			}
			flag:monaspa = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = monaspa
					SIZE = $SIZE$
				}
			}
			flag:cataphract = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = cataphract
					SIZE = $SIZE$
				}
			}
			flag:metsanvartija = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = metsanvartija
					SIZE = $SIZE$
				}
			}
			flag:horse_archers = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = horse_archers
					SIZE = $SIZE$
				}
			}
			flag:ayyar = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = ayyar
					SIZE = $SIZE$
				}
			}
			flag:mubarizun = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = mubarizun
					SIZE = $SIZE$
				}
			}
			flag:mulaththamun = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = mulaththamun
					SIZE = $SIZE$
				}
			}
			flag:archers_of_the_nile = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = archers_of_the_nile
					SIZE = $SIZE$
				}
			}
			flag:druzhina = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = druzhina
					SIZE = $SIZE$
				}
			}
			flag:hussar = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = hussar
					SIZE = $SIZE$
				}
			}
			flag:horn_warrior = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = horn_warrior
					SIZE = $SIZE$
				}
			}
			flag:bush_hunter = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = bush_hunter
					SIZE = $SIZE$
				}
			}
			flag:shomer = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = shomer
					SIZE = $SIZE$
				}
			}
			flag:garudas = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = garudas
					SIZE = $SIZE$
				}
			}
			flag:khandayat = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = khandayat
					SIZE = $SIZE$
				}
			}
			flag:mountaineer = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = mountaineer
					SIZE = $SIZE$
				}
			}
			flag:guinea_warrior = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = guinea_warrior
					SIZE = $SIZE$
				}
			}
			flag:abudrar = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = abudrar
					SIZE = $SIZE$
				}
			}
			flag:zbrojnosh = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = zbrojnosh
					SIZE = $SIZE$
				}
			}
			flag:palace_guards = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = palace_guards
					SIZE = $SIZE$
				}
			}
			flag:asawira = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = asawira
					SIZE = $SIZE$
				}
			}
			flag:tarkhan = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = tarkhan
					SIZE = $SIZE$
				}
			}
			flag:zupin_warrior = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = zupin_warrior
					SIZE = $SIZE$
				}
			}
			flag:tawashi = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = tawashi
					SIZE = $SIZE$
				}
			}
			flag:house_guard = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = house_guard
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_archers = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_archers
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_skirmishers = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_skirmishers
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_pikes = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_pikes
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_outriders = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_outriders
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_vanguards = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_vanguards
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_lancers = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_lancers
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_crossbowers = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_crossbowers
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_cameliers = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_cameliers
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_elephantiers = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_elephantiers
					SIZE = $SIZE$
				}
			}
			flag:accolade_maa_horse_archers = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = accolade_maa_horse_archers
					SIZE = $SIZE$
				}
			}
			flag:vigmen = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = vigmen
					SIZE = $SIZE$
				}
			}
			flag:bondi = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = bondi
					SIZE = $SIZE$
				}
			}
			flag:varangian_veterans = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = varangian_veterans
					SIZE = $SIZE$
				}
			}
			flag:ayrudzi = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = ayrudzi
					SIZE = $SIZE$
				}
			}
			flag:conrois = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = conrois
					SIZE = $SIZE$
				}
			}
			flag:akritai = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = akritai
					SIZE = $SIZE$
				}
			}
			flag:ballistrai = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = ballistrai
					SIZE = $SIZE$
				}
			}
			flag:skoutatoi = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = skoutatoi
					SIZE = $SIZE$
				}
			}
			flag:varangian_guards = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = varangian_guards
					SIZE = $SIZE$
				}
			}
			flag:handpicked_faithful = {	
				create_maa_or_upgrade_regiment_effect = {
					TYPE = handpicked_faithful
					SIZE = $SIZE$
				}
			}
			#OE
			flag:china_west_modao = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = pikemen
					SIZE = $SIZE$
				}				
			}
			flag:thunder = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = siege_weapon
					SIZE = $SIZE$
				}				
			}
			flag:cathay_ps = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = heavy_cavalry
					SIZE = $SIZE$
				}				
			}
			flag:china_centre_jj = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = heavy_infantry
					SIZE = $SIZE$
				}				
			}
			flag:mangudai = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = light_cavalry
					SIZE = $SIZE$
				}				
			}
			flag:samurai = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = light_cavalry
					SIZE = $SIZE$
				}				
			}
			flag:china_east_ms = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE =  skirmishers
					SIZE = $SIZE$
				}				
			}
			flag:china_south_wd = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = heavy_infantry
					SIZE = $SIZE$
				}				
			}
			flag:asia_tunguse_ss = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = archers
					SIZE = $SIZE$
				}				
			}
			flag:tiancejun = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = heavy_cavalry
					SIZE = $SIZE$
				}				
			}
			flag:java_warrior = {
				create_maa_or_upgrade_regiment_effect = {
					TYPE = skirmishers
					SIZE = $SIZE$
				}				
			}





		}
	}
}


#安置无地人
settle_landless_title_no_dlc_effect = {
	if = {
		limit = {
			NOT = { has_dlc_feature = roads_to_power }


			game_start_date = $DATE$
		}		
		create_title_and_vassal_change = {
			type = conquest
			save_scope_as = change
		}
		title:$TITLE$ = {
			change_title_holder = {
				holder = holder
				change = scope:change
			}
		}
		resolve_title_and_vassal_change = change
		holder = { destroy_title = prev }
	}
}


##################################################
# Dynasty Legacy: Bureaucracy
##################################################

ep3_dynasty_legacy_add_legitimacy_effect = {
	scope:activity = {
		if = {
			limit = {
				scope:host = {
					government_allows = administrative
					dynasty = { has_dynasty_perk = ep3_administrative_legacy_3 }
				}
				# Does the activity location have a domicile owned by a house member
				# Does that domicile have the Reception Hall building
				activity_location = {
					any_province_domicile = {
						owner = { house ?= scope:host.house }
						has_domicile_building_or_higher = reception_hall_01
					}
				}
			}
			activity_location = {
				random_province_domicile = {
					limit = {
						owner = { house ?= scope:host.house }
						has_domicile_building_or_higher = reception_hall_01
					}
					owner = { save_scope_as = reception_hall_owner }
				}
			}
			scope:host = {
				house = {
					if = {
						limit = {
							NOT = {
								has_variable = ep3_legacy_legitimacy_counter
							}
						}
						# Set the initial value
						set_variable = {
							name = ep3_legacy_legitimacy_counter
							value = 10
						}
					}
					else = {
						change_variable = {
							name = ep3_legacy_legitimacy_counter
							add = 10
						}
					}
				}
				if = {
					limit = {
						primary_title.tier = tier_empire
					}
					send_interface_toast = {
						type = event_toast_effect_good
						title = ep3_dynasty_legacy_gain_legitimacy_effect_title
						left_icon = scope:host
						right_icon = scope:host.primary_title
						add_legitimacy = 10
					}
				}
				else = {
					house = {
						every_house_member = {
							limit = { is_ai = no }
							send_interface_message = {
								type = event_generic_good_text
								title = ep3_dynasty_legacy_add_legitimacy_effect_title
								desc = ep3_dynasty_legacy_add_legitimacy_effect_desc
								left_icon = scope:host
								right_icon = house
							}
						}
					}
				}
			}
		}
	}
}



increase_imperial_bureaucracy_effect = {
	if = {
		limit = { has_realm_law_flag = uses_imperial_bureaucracy }
		#Laws
		if = {
			limit = { has_realm_law = imperial_bureaucracy_0 }
			add_realm_law = imperial_bureaucracy_1
		}
		else_if = {
			limit = { has_realm_law = imperial_bureaucracy_1 }
			add_realm_law = imperial_bureaucracy_2
		}
		else_if = {
			limit = { has_realm_law = imperial_bureaucracy_2 }
			add_realm_law = imperial_bureaucracy_3
		}
		#Laws
		if = {
			limit = { has_realm_law = celestial_bureaucracy_0 }
			add_realm_law = celestial_bureaucracy_1
		}
		else_if = {
			limit = { has_realm_law = celestial_bureaucracy_1 }
			add_realm_law = celestial_bureaucracy_2
		}
		else_if = {
			limit = { has_realm_law = celestial_bureaucracy_2 }
			add_realm_law = celestial_bureaucracy_3
		}
	}
}

decrease_imperial_bureaucracy_effect = {
	if = {
		limit = { has_realm_law_flag = uses_imperial_bureaucracy }
		#Laws
		if = {
			limit = { has_realm_law = imperial_bureaucracy_3 }
			add_realm_law = imperial_bureaucracy_2
		}
		else_if = {
			limit = { has_realm_law = imperial_bureaucracy_2 }
			add_realm_law = imperial_bureaucracy_1
		}
		else_if = {
			limit = { has_realm_law = imperial_bureaucracy_1 }
			add_realm_law = imperial_bureaucracy_0
		}
		#Laws
		if = {
			limit = { has_realm_law = celestial_bureaucracy_0 }
			add_realm_law = celestial_bureaucracy_1
		}
		else_if = {
			limit = { has_realm_law = celestial_bureaucracy_1 }
			add_realm_law = celestial_bureaucracy_2
		}
		else_if = {
			limit = { has_realm_law = celestial_bureaucracy_2 }
			add_realm_law = celestial_bureaucracy_3
		}
	}
}