#封爵
fengjue_new_title_interaction = {
	category = interaction_category_vassal
	desc = fengjue_new_title_interaction_desc
	interface_priority = 120
	icon = icon_liege
	common_interaction = no

	target_type = title
	target_filter = recipient_de_jure_titles

	is_shown = {
		#NOT = { scope:actor = scope:recipient }
		scope:recipient = {
			is_landed = yes
			primary_title.tier >= tier_county
			OR = {
				this = scope:actor #
				target_is_liege_or_above = scope:actor
				AND = {
					scope:actor.faith.religious_head = scope:recipient
					is_independent_ruler = yes
				}
			}
			NAND = {
				primary_title = { has_variable = titular_title }
				primary_title = { tier = tier_kingdom }
			}
		}
		scope:actor = {
			highest_held_title_tier = tier_empire
			government_has_flag = government_is_celestial
			is_ai = no
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	can_send = {
		trigger_if = {
			limit = {
				scope:actor = {
					highest_held_title_tier >= tier_kingdom
					has_diarchy_active_parameter = primeminister_requires_duchy
					diarch = scope:recipient
				}
			}
			custom_tooltip = {
				text = primeminister_requires_duchy.tt.blocked_grant
				any_in_list = {
					list = target_titles
					tier >= tier_duchy
				}
			}
		}
	}

	can_be_picked_title = {
		custom_description = {
			text = titular_granted
			scope:target = {
				tier < tier_kingdom
				NOT = { has_variable = titular_granted }
			}
		}
	}

	send_option = {
		is_shown = {
			exists = scope:target
			scope:recipient = {
				highest_held_title_tier <= tier_kingdom
			}
		}
		flag = kingdom
		localization = RANK_CONCEPT_KINGDOM
	}
	send_option = {
		is_shown = {
			exists = scope:target
			scope:recipient = {
				highest_held_title_tier <= tier_duchy
			}
		}
		flag = duchy
		localization = RANK_CONCEPT_DUCHY
	}
	send_options_exclusive = yes

	cost = {
		prestige = {
			value = 200
			if = {
				limit = {
					scope:kingdom = yes
				}
				add = 300
			}
		}
		piety = {
			value = 200
		}
	}

	auto_accept = yes

	on_auto_accept = {

	}

	on_accept = {
		scope:actor = {
			trigger_event = fengjue.2
		}
	}

	ai_will_do = {
		base = 0
	}
}

#无地角色，以君主头衔为地望
fengjue_landless_new_title_interaction = {
	category = interaction_category_vassal
	desc = fengjue_new_title_interaction_desc
	interface_priority = 100
	icon = icon_liege
	common_interaction = no

	target_type = title
	target_filter = actor_de_jure_titles

	is_shown = {

		#NOT = { scope:actor = scope:recipient }
		scope:recipient = {
			OR = {
				highest_held_title_tier = tier_barony
				is_landed = no
			}
			OR = {
				is_courtier_of = scope:actor
				liege = scope:actor
			}
		}
		scope:actor = {
			highest_held_title_tier = tier_empire
			government_has_flag = government_is_celestial
			is_ai = no
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	can_send = {
		trigger_if = {
			limit = {
				scope:actor = {
					highest_held_title_tier >= tier_kingdom
					has_diarchy_active_parameter = primeminister_requires_duchy
					diarch = scope:recipient
				}
			}
			custom_tooltip = {
				text = primeminister_requires_duchy.tt.blocked_grant
				any_in_list = {
					list = target_titles
					tier >= tier_duchy
				}
			}
		}
	}

	can_be_picked_title = {
		scope:target = {
			tier < tier_kingdom
			NOT = { has_variable = titular_granted }
		}
	}

	send_option = {
		is_shown = {
			exists = scope:target
			scope:recipient = {
				highest_held_title_tier <= tier_kingdom
			}
		}
		flag = kingdom
		localization = RANK_CONCEPT_KINGDOM
	}
	send_option = {
		is_shown = {
			exists = scope:target
			scope:recipient = {
				highest_held_title_tier <= tier_duchy
			}
		}
		flag = duchy
		localization = RANK_CONCEPT_DUCHY
	}
	send_options_exclusive = yes

	cost = {
		prestige = {
			value = 200
			if = {
				limit = {
					scope:kingdom = yes
				}
				add = 300
			}
		}
		piety = {
			value = 200
		}
	}

	auto_accept = yes

	on_auto_accept = {

	}

	on_accept = {
		scope:actor = {
			trigger_event = fengjue.2
		}
	}

	ai_will_do = {
		base = 0
	}
}

#起绰号
#fengjue

#追封
fengjue_dead_new_title_interaction = {
	category = interaction_category_vassal
	desc = fengjue_new_title_interaction_desc
	interface_priority = 60
	icon = icon_contract_modification_single

	popup_on_receive = yes
	pause_on_receive = yes

	greeting = positive

	is_shown = {
		scope:recipient = {
			OR = {
				this = scope:actor
				is_vassal_or_below_of = scope:actor
				is_courtier_of = scope:actor
			}
		}
		scope:actor = {
			highest_held_title_tier = tier_empire
			government_has_flag = government_is_celestial
			is_ai = no
		}
	}
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	send_option = {
		is_shown = {
			scope:recipient = {
				any_close_or_extended_family_member = {
					even_if_dead = yes
					is_alive = no
				}
			}
		}
		flag = family
		localization = option_family
	}
	send_option = {
		is_shown = {
			scope:recipient = {
				any_spouse = {
					even_if_dead = yes
					is_alive = no
				}
			}
		}
		flag = spouse
		localization = option_spouse
	}
	send_option = {
		is_shown = {
			scope:recipient = {
				any_memory = {
					OR = {
						has_memory_type = friend_died
						has_memory_type = lover_died
						has_memory_type = soulmate_died
					}
				}
			}
		}
		flag = relation
		localization = option_relation
	}
	send_option = {
		is_shown = {
			scope:recipient = {
				is_landed = yes
				primary_title ?= {
					any_past_holder = {
						exists = this
					}
				}
			}
		}
		flag = past_holder
		localization = option_past_holder
	}
	send_options_exclusive = yes

	can_send = {
		trigger_if = {
			limit = {
				scope:actor = {
					highest_held_title_tier >= tier_kingdom
					has_diarchy_active_parameter = primeminister_requires_duchy
					diarch = scope:recipient
				}
			}
			custom_tooltip = {
				text = primeminister_requires_duchy.tt.blocked_grant
				any_in_list = {
					list = target_titles
					tier >= tier_duchy
				}
			}
		}
	}

	cost = {
		gold = {
			value = 100
			if = {
				limit = { scope:recipient = { is_landed = yes } }
				multiply = scope:recipient.highest_held_title_tier
			}
		}
		piety = {
			value = 100
			if = {
				limit = { scope:recipient = { is_landed = yes } }
				multiply = scope:recipient.highest_held_title_tier
			}
		}
	}

	on_send = {
	}

	on_accept = {
		scope:actor = {
			trigger_event = shihao.11
		}
	}

	auto_accept = yes
}


########
# 旧封爵合并
########

oe_create_kingdom_1_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_kingdom_1_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:k_chinese_title_1.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes
			highest_held_title_tier = tier_empire
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_kingdom					
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
				is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_kingdom_effect = { KINGTITLE = title:k_chinese_title_1 }
		}
	}
	
	ai_will_do = {
		base = 0
	}
}
oe_create_kingdom_2_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_kingdom_2_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:k_chinese_title_2.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes
			highest_held_title_tier = tier_empire	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_kingdom					
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_kingdom_effect = { KINGTITLE = title:k_chinese_title_2 }
		}
	}
	
	ai_will_do = {
		base = 0
	}
}
oe_create_kingdom_3_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_kingdom_3_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:k_chinese_title_3.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes
			highest_held_title_tier = tier_empire	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_kingdom					
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_kingdom_effect = { KINGTITLE = title:k_chinese_title_3 }
		}
	}
	
	ai_will_do = {
		base = 0
	}
}
oe_create_kingdom_4_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_kingdom_4_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:k_chinese_title_4.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes
			highest_held_title_tier = tier_empire	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_kingdom					
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_kingdom_effect = { KINGTITLE = title:k_chinese_title_4 }
		}
	}
	
	ai_will_do = {
		base = 0
	}
}
oe_create_kingdom_5_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_kingdom_5_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:k_chinese_title_5.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes
			highest_held_title_tier = tier_empire	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_kingdom					
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_kingdom_effect = { KINGTITLE = title:k_chinese_title_5 }
		}
	}
	
	ai_will_do = {
		base = 0
	}
}
oe_create_kingdom_6_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_kingdom_6_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:k_chinese_title_6.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes
			highest_held_title_tier = tier_empire	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_kingdom					
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_kingdom_effect = { KINGTITLE = title:k_chinese_title_6 }
		}
	}
	
	ai_will_do = {
		base = 0
	}
}

#########寺监############

oe_create_duchy_1_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_duchy_1_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:d_chinese_title_1.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_duchy				
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_duchy_effect = { DUKETITLE = title:d_chinese_title_1 }
		}
		title:d_chinese_title_1.holder = {
			add_realm_law_skip_effects = official_succession_law
		}
		scope:recipient = {
			change_government_royal_government_effect = yes
		}
	}
	
	ai_will_do = {
		base = 50
	}
}
oe_create_duchy_2_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_duchy_2_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:d_chinese_title_2.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_duchy				
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_duchy_effect = { DUKETITLE = title:d_chinese_title_2 }
		}
		title:d_chinese_title_2.holder = {
			add_realm_law_skip_effects = official_succession_law
		}
		scope:recipient = {
			change_government_royal_government_effect = yes
		}
	}
	
	ai_will_do = {
		base = 50
	}
}
oe_create_duchy_3_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_duchy_3_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:d_chinese_title_3.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_duchy				
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_duchy_effect = { DUKETITLE = title:d_chinese_title_3 }
		}
		title:d_chinese_title_3.holder = {
			add_realm_law_skip_effects = official_succession_law
		}
		scope:recipient = {
			change_government_royal_government_effect = yes
		}
	}
	
	ai_will_do = {
		base = 50
	}
}
oe_create_duchy_4_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_duchy_4_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:d_chinese_title_4.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_duchy				
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_duchy_effect = { DUKETITLE = title:d_chinese_title_4 }
		}
		title:d_chinese_title_4.holder = {
			add_realm_law_skip_effects = official_succession_law
		}
		scope:recipient = {
			change_government_royal_government_effect = yes
		}
	}
	
	ai_will_do = {
		base = 50
	}
}
oe_create_duchy_5_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_duchy_5_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:d_chinese_title_5.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_duchy				
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_duchy_effect = { DUKETITLE = title:d_chinese_title_5 }
		}
		title:d_chinese_title_5.holder = {
			add_realm_law_skip_effects = official_succession_law
		}
		scope:recipient = {
			change_government_royal_government_effect = yes
		}
	}
	
	ai_will_do = {
		base = 50
	}
}
oe_create_duchy_6_interaction = {
	category = interaction_category_diplomacy
	desc = oe_create_duchy_6_interaction_desc
	interface_priority = 0
	icon = vassal_claim_liege_title_interaction

	is_shown = {
		NOT = { exists = title:d_chinese_title_6.holder }
		scope:actor = {
			is_oe_imperial_court_trigger = yes	
		}
		scope:recipient = {
			this = scope:actor
		}
	}		
	populate_actor_list = {
		scope:actor = {
			every_vassal_or_below = {
				limit = {
					highest_held_title_tier <= tier_duchy				
				}
				add_to_list = characters
			}
			every_courtier = {
				limit = {
					is_landed =no
					#NOT = { has_character_flag = in_council }
				}
				add_to_list = characters				
			}
		}
	}

	greeting = positive
	
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
		}
	}

	auto_accept = yes
		
	on_accept = {
		scope:actor = {
			OE_create_duchy_effect = { DUKETITLE = title:d_chinese_title_6 }
		}
		title:d_chinese_title_6.holder = {
			add_realm_law_skip_effects = official_succession_law
		}
		scope:recipient = {
			change_government_royal_government_effect = yes
		}
	}
	
	ai_will_do = {
		base = 50
	}
}