@designate_heir_cost = 1000
# Set one of your children as heir



#This interaction is referenced in code! If it's renamed you have to ping a coder
designate_heir_interaction = {
	icon = heir

	category = interaction_category_diplomacy

	desc = designate_heir_interaction_desc

	is_shown = {
		scope:recipient = {
			is_close_family_of = scope:actor
			NOT = { is_parent_of = scope:actor }
		}
		scope:actor = {
			OR = {
				has_realm_law = tradition_succession_law
				has_realm_law = player_official_succession_law
			}
			can_designate_heir_trigger = yes
		}
		NOR = {
			scope:recipient = scope:actor.designated_heir
			scope:recipient = scope:actor.primary_heir
			scope:recipient = scope:actor
		}
	}

	is_valid_showing_failures_only = {
		scope:recipient = {
			is_busy_in_events_localised = yes
			NOR = {
				has_trait = disinherited
				has_trait = eunuch
				has_trait = devoted
				has_trait = order_member
				has_trait = bastard
			}
		}
		scope:actor = { prestige >= @designate_heir_cost }
	}

	on_auto_accept = {
		scope:recipient = {
			trigger_event = char_interaction.0120
		}
	}

	on_accept = {
		scope:actor = {
			send_interface_toast = {
				title = designate_heir_interaction_notification

				left_icon = scope:actor					
				right_icon = scope:recipient

				set_designated_heir = scope:recipient
				if = {
					limit = {
						NOR = {
							has_realm_law = tradition_succession_law
							has_realm_law = player_official_succession_law
						}
					}
					add_prestige = { subtract = @designate_heir_cost }
				}
			}
		}
	}

	auto_accept = yes
}


sekke_designate_heir_interaction = {
	category = interaction_category_friendly
	#common_interaction = yes
	greeting = positive
	icon = icon_entrench_regency	
	desc = great_misit_waste_crown_prince_interaction_desc
	needs_recipient_to_open = yes

	populate_actor_list = {
		scope:recipient = {
			every_close_family_member = {
				limit = {
					OR = {
						is_ruler = no
						highest_held_title_tier <= 2
					}
				}
				add_to_list = characters
			}
		}
	}
	is_shown = {
		scope:actor = {
			has_title = title:k_yamato
			is_ai = no
		}
		scope:recipient = { 
			has_primary_title = title:d_gosho
		}
	}
	has_valid_target_showing_failures_only = {
		scope:secondary_actor = {
			is_incapable = no
		}
		NOT = {
			scope:secondary_actor = scope:recipient.designated_heir
		}
	}
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
			is_imprisoned = no
			is_incapable = no
		}
	}
	
	cost = {
		prestige = 200
		piety = 200
	}

	on_accept = {
		scope:actor = {
			trigger_event = {
				id = great_misit.0006
				days = 3
			}
			scope:secondary_actor = {
				set_character_faith = faith:shinto
			}
			scope:recipient = {
				set_designated_heir = scope:secondary_actor
			}
		}
		
	}
	auto_accept = yes
}





replace_tenno_interaction = {
	category = interaction_category_friendly
	#common_interaction = yes
	greeting = positive
	icon = icon_entrench_regency	
	desc = replace_tenno_interaction_desc
	needs_recipient_to_open = yes

	is_shown = {
		scope:actor = {
			has_title = title:k_yamato
			is_ai = no
		}
		scope:recipient = { 
			has_primary_title = title:d_gosho
		}
	}
	is_valid_showing_failures_only = {
		scope:actor = {
			is_adult = yes
			is_imprisoned = no
			is_incapable = no
		}
		scope:recipient = { 
			exists = primary_heir
		}
	}
	
	cost = {
		prestige = 500
		piety = 200
	}

	on_accept = {
		scope:recipient = { 
			depose = yes

			if = {
				limit = {
					religion = religion:buddhism_religion
				}
				add_trait = hoo
			}
			else = {
				add_trait = joko
			}
		}
		
	}
	auto_accept = yes
}