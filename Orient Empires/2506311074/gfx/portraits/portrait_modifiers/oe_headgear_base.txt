# Tags:
# rank_headgear: any headgear that signifies a certain title. crowns, pope hat etc.

oe_headgear_base = {

	usage = game
	selection_behavior = weighted_random
	priority = 3
	
	## China ##

	chinese_illusion_iu_hairs = { #发簪
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = chinese_illusion_iu_hairs
				range = { 0 1 } # For the randomness to work correctly
			}
		}   
		weight = {
			base = 0
			modifier = {
				add = 20
				NOR = {
                    has_gene = {
                        category = gene_hair_type
                        template = hair_straight
                    }
                    has_gene = {
                        category = gene_hair_type
                        template = hair_straight_thin_beard
                    }
                    has_gene = {
                        category = gene_hair_type
                        template = hair_wavy
                    }
                    has_gene = {
                        category = gene_hair_type
                        template = hair_curly
                    }
                    has_gene = {
                        category = gene_hair_type
                        template = hair_afro
                    }
                }
				portrait_commoner_clothing_trigger = {
                    CULTURE_INPUT = chinese
                }
			}
		}
	}

	chinese_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = chinese_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 20
				portrait_commoner_clothing_trigger = {
                    CULTURE_INPUT = chinese
                }
			}
		}
	}

	chinese_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = chinese_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 50
                court_fashion_level_4_trigger = {
                    CULTURE_INPUT = chinese
                }
			}
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = { 
                    CULTURE_INPUT = chinese
				}
			}
		}
	}

	chinese_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = chinese_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 50
                court_fashion_level_5_trigger = {
                    CULTURE_INPUT = chinese
                }
			}
			modifier = {
				add = 50
                portrait_high_nobles_clothing_trigger = { 
                    CULTURE_INPUT = chinese
                }
			}
		}
	}

	chinese_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = no_headgear
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = {
				mode = add
				gene = headgear
				template = chinese_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 110
				portrait_royalty_clothing_trigger = { 
					CULTURE_INPUT = chinese
				}
			}
		}
	}
	
	chinese_princes = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = no_headgear
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = {
				mode = add
				gene = headgear
				template = chinese_prince
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 100
				any_parent = { 
					OR = {
						is_oe_imperial_clothing_trigger = yes
						portrait_imperial_clothing_trigger = { 
							CULTURE_INPUT = chinese
						}
					}
				}
				NOT = { has_character_flag = flag_song_clothing	}
			}
		}
	}
	
	chinese_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = no_headgear
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = {
				mode = add
				gene = headgear
				template = chinese_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 120
				OR = {
					is_oe_imperial_clothing_trigger = yes
					portrait_imperial_clothing_trigger = { 
						CULTURE_INPUT = chinese
					}
				}
			}
		}
	}

	chinese_imperial_song = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = chinese_imperial_song_headgear
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = -50
			modifier = {
				add = 150
				is_oe_imperial_clothing_trigger = yes
			}
			modifier = {
				add = 40
				is_oe_court_fashion_level_5_trigger = yes
			}
			modifier = {
				add = 50
				portrait_song_clothing_trigger = yes
			}
		}
	}

	chinese_song_headgear = { #展脚幞头
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = chinese_song_headgear
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = -50
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = { 
                    CULTURE_INPUT = chinese
                }
			}
			modifier = {
				add = 60
                portrait_high_nobles_clothing_trigger = { 
                    CULTURE_INPUT = chinese
                }
			}
			modifier = {
				add = 150
				portrait_song_clothing_trigger = yes
			}
			modifier = {
				factor = 0
				portrait_song_era_trigger = no
			}
		}
	}

	# Bai
	bai_royalty = { #大理礼冠
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = bai_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 120
				culture = culture:bai
				portrait_royalty_clothing_trigger = { 
					CULTURE_INPUT = chinese
				}
			}
		}
	}

	# Shogunate

	shogunate_no_headgear = {

		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = no_headgear
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		
		weight = {
			base = 0
			# No headgear for Japanese characters
			modifier = {
				add = 50
				OR = {
					portrait_japanese_clothing_trigger = yes
					#portrait_ryukyu_clothing_trigger = yes
					portrait_ainu_clothing_trigger = yes
				}
			}
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = { 
                    CULTURE_INPUT = japanese
                }
			}
			modifier = {
				add = 50
				portrait_wear_armor_trigger = yes
			}
		}
	}

	shogunate_japanese_suieikan = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = shogunate_suieikan
				range = { 0 1 }
			}
		}
		
		weight = {
			base = 0
			modifier = {
				add = 50
                court_fashion_level_5_trigger = {
                    CULTURE_INPUT = japanese
                }
			}
			modifier = {
				add = 50
                portrait_high_nobles_clothing_trigger = { 
                    CULTURE_INPUT = japanese
                }
			}
			modifier = {
				add = -100
				AND = {
					#scope:age >= 16
					shogunate_should_be_no_hair_trigger = yes
					#portrait_japanese_clothing_trigger = yes
				}
			}
		}
	}

## AUSTRONESIAN ##

	austronesian_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mmjm_common
				value = 1  # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 20
                portrait_commoner_clothing_trigger = {
                    CULTURE_INPUT = austronesian
                }
			}
		}
	}

	austronesian_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mmjm_nobility
				value = 1  # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 50
				court_fashion_level_4_trigger = {
					CULTURE_INPUT = austronesian
				}
			}
			modifier = {
				add = 50
				portrait_low_nobles_clothing_trigger = { 
					CULTURE_INPUT = austronesian
				}
			}
		}
	}

	austronesian_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mmjm_nobility
				value = 1  # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0		
			modifier = {
				add = 50
                court_fashion_level_5_trigger = {
                    CULTURE_INPUT = austronesian
                }
			}
			modifier = {
				add = 50
                portrait_high_nobles_clothing_trigger = { 
                    CULTURE_INPUT = austronesian
                }
			}
		}
	}

	austronesian_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mmjm_royalty
				value = 1  # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 101
                portrait_royalty_trigger = { 
                    CULTURE_INPUT = austronesian
                }
			}
			modifier = {
				add = 51
				portrait_imperial_clothing_trigger = { 
                    CULTURE_INPUT = austronesian
                }		
			}
		}
	}

	austronesian_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = indian_war
				value = 1  # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 101
				portrait_wear_armor_trigger = yes
				portrait_austronesian_clothing_trigger = yes

			}
		}
	}
}
